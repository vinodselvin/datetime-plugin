function populateYears(a){var t='.vi-date[data-vi-format="'+a+'"]';for($(t).parent().find(".vyears").append($("<option />").val(0).html("yyyy")),i=(new Date).getFullYear();i>1900;i--)$(t).parent().find(".vyears").append($("<option />").val(i).html(i))}function populateMonths(a){var t='.vi-date[data-vi-format="'+a+'"]';for($(t).parent().find(".vmonths").append($("<option />").val(0).html("mm")),i=1;i<13;i++)$(t).parent().find(".vmonths").append($("<option />").val(i).html(i))}function updateNumberOfDays(){for($(".vdays").html(""),month=$(".vmonths").val(),year=$(".vyears").val(),days=daysInMonth(month,year),$(".vdays").append($("<option />").val(0).html("dd")),i=1;i<days+1;i++)$(".vdays").append($("<option />").val(i).html(i))}function daysInMonth(a,t){return new Date(t,a,0).getDate()}function processDate(a,t,e,n){var i=n,s={vmonths:"mm",vdays:"dd",vyears:"yyyy"};return $.each(s,function(s,d){if(s==e)if(""!=a){var l=n.split("-"),v=a.split("-"),o=d;$.each(l,function(e,n){n==d&&(v[e]==v[e-1]?(o="-"+v[e-1],t="-"+t,i=a.replace(o,t)):(o=v[e],i=a.replace(o,t)))})}else i=i.replace(d,t)}),i}$(function(){$(".vi-date").wrap('<div class="wrap-date"></div>');for(var a=["dd-mm-yyyy","mm-yyyy","dd-yyyy","yyyy","dd","mm","dd-mm"],t='<select class="vdays"></select>',e='<select class="vmonths"></select>',n='<select class="vyears"></select>',i=0;i<a.length;i++){var s=a[i],d='.vi-date[data-vi-format="'+s+'"]',l="";s.includes("dd")&&(l+=t),s.includes("mm")&&(l+=e),s.includes("yyyy")&&(l+=n),$(d).hide(),$(d).after(l),populateYears(s),populateMonths(s),updateNumberOfDays()}}),$(document).ready(function(){$(".vi-date").nextAll("select").on("change",function(a){var t=$(this).prevAll(".vi-date").val(),e=$(this).val(),n=$(this).attr("class"),i=$(this).prevAll(".vi-date").data("vi-format"),s=$(this).prevAll(".vi-date"),d=processDate(t,e,n,i);s.val(d)})});